<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Test Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: white;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 2px solid;
        }
        .success { background: #0be881; color: #000; border-color: #00a859; }
        .error { background: #ff4757; color: #fff; border-color: #d63031; }
        .info { background: #54a0ff; color: #fff; border-color: #2e86de; }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        button {
            background: #4ecdc4;
            color: #000;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover { background: #45b8b0; }
    </style>
</head>
<body>
    <h1>üîç Dashboard Diagnostic Test</h1>
    
    <div id="status"></div>
    
    <h2>Test Results:</h2>
    <div id="results"></div>
    
    <button onclick="runTests()">Run Tests Again</button>
    <button onclick="window.location.href='warehouse_dashboard_complete.html'">Go to Dashboard</button>
    
    <script>
        async function runTests() {
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            statusDiv.innerHTML = '<div class="status info">üîÑ Running tests...</div>';
            resultsDiv.innerHTML = '';
            
            let results = '';
            
            // Test 1: Check if we can fetch the JSON file
            results += '<h3>Test 1: Can we fetch warehouse_data.json?</h3>';
            try {
                const response = await fetch('warehouse_data.json');
                
                if (response.ok) {
                    results += '<div class="status success">‚úÖ SUCCESS: warehouse_data.json found!</div>';
                    results += `<p>Status: ${response.status} ${response.statusText}</p>`;
                    
                    // Test 2: Can we parse the JSON?
                    results += '<h3>Test 2: Can we parse the JSON?</h3>';
                    try {
                        const data = await response.json();
                        results += '<div class="status success">‚úÖ SUCCESS: JSON parsed successfully!</div>';
                        
                        // Test 3: Does the data have the right structure?
                        results += '<h3>Test 3: Data Structure Check</h3>';
                        if (data.totals) {
                            results += '<div class="status success">‚úÖ SUCCESS: "totals" object exists</div>';
                            
                            results += '<h4>Key Values:</h4>';
                            results += `<pre>${JSON.stringify({
                                loader_running_total: data.totals.loader_running_total,
                                loader_days_tracked: data.totals.loader_days_tracked,
                                loader_avg_per_day: data.totals.loader_avg_per_day,
                                pallets_picked: data.totals.pallets_picked,
                                pallets_putaway: data.totals.pallets_putaway,
                                last_updated: data.last_updated
                            }, null, 2)}</pre>`;
                            
                        } else {
                            results += '<div class="status error">‚ùå ERROR: "totals" object missing!</div>';
                            results += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                        }
                        
                        // Test 4: Show all data
                        results += '<h3>Complete JSON Data:</h3>';
                        results += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                        
                        statusDiv.innerHTML = '<div class="status success">‚úÖ ALL TESTS PASSED! Your data is ready.</div>';
                        
                    } catch (jsonError) {
                        results += '<div class="status error">‚ùå ERROR: Could not parse JSON</div>';
                        results += `<pre>${jsonError.message}</pre>`;
                        statusDiv.innerHTML = '<div class="status error">‚ùå FAILED: JSON parsing error</div>';
                    }
                    
                } else {
                    results += '<div class="status error">‚ùå ERROR: Could not load warehouse_data.json</div>';
                    results += `<p>Status: ${response.status} ${response.statusText}</p>`;
                    results += `<p>This usually means the file is not in the same folder as this HTML file.</p>`;
                    statusDiv.innerHTML = '<div class="status error">‚ùå FAILED: File not found</div>';
                }
                
            } catch (fetchError) {
                results += '<div class="status error">‚ùå ERROR: Network/Fetch error</div>';
                results += `<pre>${fetchError.message}</pre>`;
                results += `<p>Possible causes:</p>
                    <ul>
                        <li>File not uploaded to GitHub</li>
                        <li>File in wrong folder</li>
                        <li>GitHub Pages not enabled</li>
                    </ul>`;
                statusDiv.innerHTML = '<div class="status error">‚ùå FAILED: Cannot fetch file</div>';
            }
            
            // Test 5: Check if dashboard HTML elements exist
            results += '<h3>Test 4: Dashboard HTML Check</h3>';
            results += `<p>Looking for element IDs that the dashboard needs:</p>`;
            const requiredIds = ['loader-total', 'loader-days', 'loader-avg', 'picker-total', 'putaway-total'];
            let foundIds = 0;
            requiredIds.forEach(id => {
                const elem = document.getElementById(id);
                if (elem) {
                    results += `<p>‚úÖ Found: #${id}</p>`;
                    foundIds++;
                } else {
                    results += `<p>‚ùå Missing: #${id}</p>`;
                }
            });
            
            if (foundIds === 0) {
                results += '<p class="status info">‚ÑπÔ∏è This is the test page, not the dashboard. IDs not found here is normal.</p>';
            }
            
            resultsDiv.innerHTML = results;
        }
        
        // Run tests on page load
        window.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>
